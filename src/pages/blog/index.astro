---
import { getCollection } from "astro:content";
import { format } from "date-fns";
import Layout from "../../layouts/Layout.astro";

const allBlogPosts = await getCollection("blog");
// Sort by date, newest first
const blogPosts = allBlogPosts.sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
);

const title = "IMPHNEN Blog - Lazy Programming Tips & Humor";
const description =
  "Articles, guides, and memes for programmers who want to be experts but are reluctant to code.";
---

<Layout title={title} description={description} url="">
  <main class="flex-1">
    <!-- Hero section -->
    <section class="bg-muted py-12 md:py-16 lg:py-20">
      <div class="container">
        <div class="max-w-3xl mx-auto text-center">
          <h1 class="text-3xl md:text-4xl font-bold tracking-tight mb-4">
            The IMPHNEN Blog
          </h1>
          <p class="text-muted-foreground mb-8">
            Practical advice, humorous takes, and solidarity for programmers who
            aspire to greatness but prefer to avoid the actual work.
          </p>
        </div>
      </div>
    </section>

    <!-- Blog listing -->
    <section class="py-12 md:py-16">
      <div class="container">
        <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
          {
            blogPosts.map((post) => (
              <article class="rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden group hover:shadow-md transition-all">
                <div class="aspect-video w-full overflow-hidden bg-muted">
                  <img
                    src={post.data.image}
                    alt={`Illustration for ${post.data.title}`}
                    class="object-cover w-full h-full transition-transform group-hover:scale-105"
                  />
                </div>
                <div class="p-6">
                  <div class="flex items-center gap-2 text-sm text-muted-foreground mb-3">
                    <span>{post.data.category}</span>
                    <span>â€¢</span>
                    <time datetime={post.data.pubDate.toISOString()}>
                      {format(post.data.pubDate, "MMMM d, yyyy")}
                    </time>
                  </div>
                  <h2 class="text-xl font-semibold mb-2 group-hover:text-primary transition-colors">
                    <a href={`/blog/${post.slug}`} class="hover:underline">
                      {post.data.title}
                    </a>
                  </h2>
                  <p class="text-muted-foreground mb-4">{post.data.excerpt}</p>
                  <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-muted overflow-hidden mr-2" />
                    <span class="text-sm">{post.data.author}</span>
                  </div>
                </div>
              </article>
            ))
          }
        </div>
      </div>
    </section>
  </main>
</Layout>
